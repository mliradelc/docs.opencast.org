<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Workflow - Opencast - Administration Guide</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Workflow";
    var mkdocs_page_input_path = "configuration/workflow.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Opencast - Administration Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../releasenotes/">Release Notes</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../upgrade/">Upgrade</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../changelog/">Changelog</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../installation/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../installation/multiple-servers/">Multiple Servers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Installation from Source</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/source-linux/">Linux</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/source-macosx/">MacOS X</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Installation from Package</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/debs/">Debian/Ubuntu</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/rpm-fedora/">Fedora</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/rpm-rhel-sl-centos/">RHEL/CentOS</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Installation with Docker</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../installation/docker-local/">Testing Locally</a>
                </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Configuration</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../basic/">Basic</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../database/">Database</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">HTTPS</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../https/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../https/nginx/">Using Nginx</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../https/opencast.only/">Internal HTTPS</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../https/migration/">Migrating old content to HTTPS</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../asset-manager/">Asset Manager</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../message-broker/">Message Broker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../metadata/">Metadata</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../asset-upload-ui/">Manual Asset Upload</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../encoding/">Encoding</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../load/">Load</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../user-statistics.and.privacy/">Logging and Privacy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../multi.tenancy/">Multi Tenancy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Authentication, Autorization and User Management</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../security/">General Security</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../acl/">Access Control Lists</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../security.aai/">Authentication and Authorization Infrastructure (AAI)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../security.cas/">Central Authentication Service (CAS)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../security.ldap/">LDAP Authentication and Authorization (without CAS)</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../security.user.moodle/">Moodle User Provider</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../security.user.sakai/">Sakai User Provider</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../stream-security/">Stream Security</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Workflow</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#document">Document</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#create-a-workflow">Create a Workflow</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#encoding-profiles">Encoding Profiles</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#describe-the-workflow">Describe the Workflow</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#inspect-the-media">Inspect the Media</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#encoding">Encoding</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#encode-to-thumbnail">Encode to Thumbnail</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#distribute-the-media">Distribute the Media</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#accept-user-input">Accept User Input</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#conditional-execution">Conditional Execution</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#test-the-workflow">Test the Workflow</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../external-api/">External API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../oaipmh/">OAI-PMH</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../version-support/">Version Support</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Modules</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/atomrss/">Atom/RSS Feed</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/awss3distribution/">AWS S3 Distribution</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/execute/">Execute Service</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/liveschedule/">Live Schedule</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/ltimodule/">LTI Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/mediamodule.configuration/">Media Module</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Player</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/player.configuration/">Configuration</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/player.url.parameter/">URL Parameters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/player.matomo.tracking/">Matomo Tracking</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/paella.player/">Paella player</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/searchindex/">Search Index</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/stream-security/">Stream Security</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/textextraction/">Text Extraction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/timelinepreviews/">Timeline Previews</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/watsontranscripts/">Transcripts (IBM Watson)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="#">Video Editor</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/videoeditor.setup/">Setup</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../modules/videoeditor.architecture/">Architecture</a>
                </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/videosegmentation/">Video Segmentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/waveform/">Waveform Service</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/adaptivestreaming-wowza/">Wowza Adaptive Streaming Distribution Service</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../modules/youtubepublication/">YouTube Publication</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Workflow Operation Handler</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/">Overview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retry-strategies/">Retry Strategies</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/analyze-tracks-woh/">Analyze Tracks</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/analyzeaudio-woh/">Analyze Audio</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/animate-woh/">Animate</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/snapshot-woh/">Asset Snapshot</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/asset-delete-woh/">Asset Delete</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/attach-watson-transcription-woh/">Attach Watson Transcription</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/cleanup-woh/">Cleanup</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/comment-woh/">Comment</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/compose-woh/">Compose</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/composite-woh/">Composite</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/concat-woh/">Concat</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/configure-by-dcterm-woh/">Configure-By-DCTerm</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/copy-woh/">Copy</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/clone-woh/">Clone</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/coverimage-woh/">Cover Image</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/defaults-woh/">Defaults</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/duplicate-event-woh/">Duplicate Event</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/editor-woh/">Editor</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/encode-woh/">Encode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/error-resolution-woh/">Error Resolution</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/execute-once-woh/">Execute Once</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/execute-many-woh/">Execute Many</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/export-wf-properties-woh/">Export Workflow Properties</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/extracttext-woh/">Extract Text</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/failing-woh/">Failing</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/httpnotify-woh/">HTTP Notify</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/image-woh/">Image</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/imagetovideo-woh/">Image to Video</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/import-wf-properties-woh/">Import Workflow Properties</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/incident-woh/">Incident</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/include-woh/">Include</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/ingestdownload-woh/">Ingest-Download</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/inspect-woh/">Inspect</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/log-woh/">Log</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/normalizeaudio-woh/">Normalize Audio</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/partial-import-woh/">Partial Import</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/postmediapackage-woh/">Post Media Package</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/prepareav-woh/">Prepare A/V</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/probe-resolution-woh/">Probe Resolution</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/publish-aws-woh/">Publish AWS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/publish-configure-woh/">Publish Configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/publish-engage-woh/">Publish Engage</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/publish-oaipmh-woh/">Publish OAI-PMH</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/publish-youtube-woh/">Publish YouTube</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/republish-oaipmh-woh/">Republish OAI-PMH</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retract-aws-woh/">Retract AWS S3 and Cloudfront</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retract-engage-woh/">Retract Engage</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retract-configure-woh/">Retract Configure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retract-oaipmh-woh/">Retract OAI-PMH</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/retract-youtube-woh/">Retract YouTube</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/segmentpreviews-woh/">Segment Previews</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/segmentvideo-woh/">Segment Video</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/send-email-woh/">Send Email</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/series-woh/">Series</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/silence-woh/">Silence</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/start-watson-transcription-woh/">Start Watson Transcription</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/tag-woh/">Tag</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/tag-by-dcterm-woh/">Tag-By-DCTerm</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/timelinepreviews-woh/">Timelinepreviews</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/theme-woh/">Theme</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/waveform-woh/">Waveform</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../workflowoperationhandlers/zip-woh/">Zip</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Opencast - Administration Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Configuration &raquo;</li>
        
      
    
    <li>Workflow</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/opencast/opencast/tree/develop/docs/guides/admin/docs/edit/master/docs/configuration/workflow.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="create-a-custom-workflow">Create a Custom Workflow</h1>
<p>This document will help you get started with creating your own Opencast workflows. For a list of available workflow
operations, see:</p>
<blockquote>
<p><a href="../../workflowoperationhandlers/">List of Workflow Operation Handler</a></p>
</blockquote>
<h2 id="overview">Overview</h2>
<p>A Opencast workflow is an ordered list of operations. There is no limit to the number of operations or their
repetition in a given workflow.</p>
<p>Workflow operations can be configured using configuration elements. The use of string replacement in configuration
values allows workflows to dynamically adapt to a given input or user decision.</p>
<h3 id="document">Document</h3>
<p>Opencast workflows are defined in XML.  The structure of a Opencast workflow looks like this:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;

  &lt;!-- Description --&gt;
  &lt;id&gt;&lt;/id&gt;
  &lt;title&gt;&lt;/title&gt;
  &lt;tags&gt;&lt;/tags&gt;
  &lt;description&gt;&lt;/description&gt;

  &lt;!-- Operations --&gt;
  &lt;operations&gt;
    &lt;operation&gt;&lt;/operation&gt;
    ...
  &lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<h2 id="create-a-workflow">Create a Workflow</h2>
<p>This sections will walk you through creating a custom workflow, which will encode ingested tracks to defined output
format.</p>
<h3 id="encoding-profiles">Encoding Profiles</h3>
<p>First create or select the encoding profiles you want to use. For more details on this, have a look at the <a href="../encoding/">Encoding
Profile Configuration Guide</a>. For this guide we assume that we have an encoding profile <code>mov-low.http</code>
which creates a distribution format definition for mp4 video and a <code>feed-cover.http</code> encoding profile to create
thumbnail images for the videos.</p>
<h3 id="describe-the-workflow">Describe the Workflow</h3>
<p>Start by naming the workflow and giving it a meaningful description:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;

  &lt;!-- Description --&gt;
  &lt;id&gt;example&lt;/id&gt;
  &lt;title&gt;Encode Mp4, Distribute and Publish&lt;/title&gt;
  &lt;tags&gt;
    &lt;!-- Tell the UI where to show this workflow --&gt;
    &lt;tag&gt;upload&lt;/tag&gt;
    &lt;tag&gt;schedule&lt;/tag&gt;
    &lt;tag&gt;archive&lt;/tag&gt;
  &lt;/tags&gt;
  &lt;description&gt;
    Encode to Mp4 and thumbnail.
    Distribute to local repository.
    Publish to search index.
  &lt;/description&gt;

  &lt;!-- Operations --&gt;
  &lt;operations&gt;&lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<ul>
<li>The <code>id</code> is used in several Opencast endpoints to identify and select this workflow. Make sure that this identifier
  is unique among all endpoints in the system.</li>
<li>The <code>tags</code> define where the user interfaces may use these workflows. Useful tags are:<ul>
<li><em>upload</em>: Usable for uploaded media</li>
<li><em>schedule</em>: Usable for scheduled events</li>
<li><em>archive</em>: Usable for archived media</li>
<li><em>delete</em>: Usable for deletion of events with publications</li>
<li><em>editor</em>: Usable from the video editor</li>
</ul>
</li>
</ul>
<h3 id="inspect-the-media">Inspect the Media</h3>
<p>The first operation will be to inspect the media for technical metadata, such as format and length:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;

  &lt;!-- Description --&gt;
  ...

  &lt;!-- Operations --&gt;
  &lt;operations&gt;

    &lt;!-- inspect media --&gt;
    &lt;operation
      id="inspect"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Inspect media package"&gt;
    &lt;/operation&gt;

  &lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<p>The <em>fail-on-error</em> attribute is a boolean determining whether the workflow will throw an error to the
exception-handler-workflow or simply proceed with the remaining operations.</p>
<h3 id="encoding">Encoding</h3>
<p>The next operations will encode the media to the Mp4 format:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;

  &lt;!-- Description --&gt;
  ...

  &lt;!-- Operations --&gt;
  &lt;operations&gt;

    &lt;!-- inspect media --&gt;
    ...

    &lt;!-- encode: mp4 --&gt;
    &lt;operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode camera to mp4"&gt;
      &lt;configurations&gt;
        &lt;configuration key="source-flavor"&gt;presenter/source&lt;/configuration&gt;
        &lt;configuration key="target-flavor"&gt;presenter/delivery&lt;/configuration&gt;
        &lt;configuration key="target-tags"&gt;rss, atom&lt;/configuration&gt;
        &lt;configuration key="encoding-profile"&gt;mov-low.http&lt;/configuration&gt;
      &lt;/configurations&gt;
    &lt;/operation&gt;

    &lt;operation
      id="compose"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode screen to mp4"&gt;
      &lt;configurations&gt;
        &lt;configuration key="source-flavor"&gt;presentation/source&lt;/configuration&gt;
        &lt;configuration key="target-flavor"&gt;presentation/delivery&lt;/configuration&gt;
        &lt;configuration key="target-tags"&gt;rss, atom&lt;/configuration&gt;
        &lt;configuration key="encoding-profile"&gt;mov-low.http&lt;/configuration&gt;
      &lt;/configurations&gt;
    &lt;/operation&gt;

  &lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<ul>
<li>The <code>target-tags</code> attribute causes the resulting media to be tagged. For example, this could be used to define these
  media as input for other operations, using their <code>source-tags</code> attribute.</li>
<li>The <code>encoding-profile</code> attribute refers to an encoding profile defined in <code>etc/encoding</code>.</li>
</ul>
<h3 id="encode-to-thumbnail">Encode to Thumbnail</h3>
<p>The next operations will create thumbnails from the media:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;
  ...
  &lt;operations&gt;
    ...
    &lt;!-- encode: images --&gt;
    &lt;operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode camera to thumbnail"&gt;
      &lt;configurations&gt;
        &lt;configuration key="source-flavor"&gt;presenter/source&lt;/configuration&gt;
        &lt;configuration key="source-tags"&gt;&lt;/configuration&gt;
        &lt;configuration key="target-flavor"&gt;cover/source&lt;/configuration&gt;
        &lt;configuration key="target-tags"&gt;rss, atom&lt;/configuration&gt;
        &lt;configuration key="encoding-profile"&gt;feed-cover.http&lt;/configuration&gt;
        &lt;configuration key="time"&gt;1&lt;/configuration&gt;
      &lt;/configurations&gt;
    &lt;/operation&gt;

    &lt;operation
      id="image"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Encode screen to thumbnail"&gt;
      &lt;configurations&gt;
        &lt;configuration key="source-flavor"&gt;presentation/source&lt;/configuration&gt;
        &lt;configuration key="source-tags"&gt;&lt;/configuration&gt;
        &lt;configuration key="target-flavor"&gt;cover/source&lt;/configuration&gt;
        &lt;configuration key="target-tags"&gt;rss, atom&lt;/configuration&gt;
        &lt;configuration key="encoding-profile"&gt;feed-cover.http&lt;/configuration&gt;
        &lt;configuration key="time"&gt;1&lt;/configuration&gt;
      &lt;/configurations&gt;
    &lt;/operation&gt;

  &lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<ul>
<li>The time attribute determines the approximate frame of the source media is used. The time unit is in seconds.</li>
</ul>
<h3 id="distribute-the-media">Distribute the Media</h3>
<p>The next operation copies the encoded media to the Opencast distribution channel:</p>
<pre><code>&lt;definition xmlns="http://workflow.opencastproject.org"&gt;
  ...
  &lt;operations&gt;

    &lt;!-- distribute: local --&gt;
    &lt;operation
      id="publish-engage"
      fail-on-error="true"
      exception-handler-workflow="error"
      description="Distribute media to the local distribution channel"&gt;
      &lt;configurations&gt;
        &lt;configuration key="download-source-tags"&gt;publish,rss,atom&lt;/configuration&gt;
        &lt;configuration key="streaming-source-tags"&gt;&lt;/configuration&gt;
        &lt;configuration key="check-availability"&gt;true&lt;/configuration&gt;
      &lt;/configurations&gt;
    &lt;/operation&gt;

  &lt;/operations&gt;

&lt;/definition&gt;
</code></pre>
<ul>
<li>The publish-engage operation uses all media tagged as <em>rss</em> or <em>atom</em> as input.</li>
</ul>
<h2 id="accept-user-input">Accept User Input</h2>
<p>Workflow definitions may optionally include variables to be replaced by user input. For instance, this may be used to
select optional parts of a workflow. To enable user control of individual workflow instances, the workflow definition
must:</p>
<ul>
<li>use the <code>${variable}</code> notation in the workflow definition</li>
<li>contain a custom configuration panel.</li>
</ul>
<p>Here is an example of a configurable operation:</p>
<pre><code>&lt;operation id="..." if="${somevar}"&gt;
  ...
&lt;/operation&gt;
</code></pre>
<p>The attribute <code>if</code> specifies the execution condition in means of the operation only being executed if that condition
evaluates to true. You can find more details on conditional execution in the next section.</p>
<p>Once the operation is configured to accept a variable, we need to describe how to gather the value from the
administrative user. The <code>&lt;configuration_panel&gt;</code> element of a workflow definitions describes this user interface
snippet.  A simple configuration panel could look like this:</p>
<pre><code>&lt;configuration_panel&gt;
  &lt;![CDATA[
    &lt;input id="someaction" name="someaction" type="checkbox" value="true" /&gt;
    &lt;label for="someaction"&gt;Execute some operation?&lt;/label&gt;
  ]]&gt;
&lt;/configuration_panel&gt;
</code></pre>
<p>The checkbox in this <code>&lt;configuration_panel&gt;</code> will now be displayed in the administrative tools, and the user's
selection will be used to replace the <code>${someaction}</code> variable in the workflow.</p>
<p>This input can also be sent by capture agents, using the ingest endpoints. Please note that capture agents usually do
not load the configuration panel. Hence defaults set in the user interface will not apply to ingests. To circumvent
this, the <a href="../../workflowoperationhandlers/defaults-woh/">defaults operation</a> can be used.</p>
<h2 id="conditional-execution">Conditional Execution</h2>
<p>The attribute <code>if</code> of the <code>operation</code> element can be used to specify a condition to control whether the workflow
operation should be executed. This so-called execution condition is a boolean expression of the following form:</p>
<pre><code>&lt;expression&gt; ::= &lt;term&gt; ["OR" &lt;expression&gt;]
&lt;term&gt; ::= &lt;value&gt; ["AND" &lt;term&gt;]
&lt;value&gt; ::= ["NOT"]* ( "(" &lt;expression&gt; ")" | &lt;relation&gt; | &lt;bool-literal&gt; )
&lt;relation&gt; ::= &lt;relation-factor&gt; &lt;rel-literal&gt; &lt;relation-factor&gt;
&lt;relation-factor&gt; ::= &lt;operation&gt; | &lt;number&gt;
&lt;operation&gt; ::= &lt;number&gt; &lt;op-literal&gt; &lt;number&gt;
&lt;rel-literal&gt; ::= "&gt;=" | "&gt;" | "&lt;=" | "&lt;" | "==" | "!="
&lt;op-literal&gt; ::= "+" | "-" | "*" | "/"
&lt;bool-literal&gt; ::= "true" | "false"
</code></pre>
<p>As the formal description above explains, such boolean expressions may contain the booelan constants (<code>true</code> and
<code>false</code>) and numbers, as well as references to the variables of the workflow instance that contain these data types.
Workflow instance variables can be accessed by using <code>${variableName}</code>.</p>
<p>Example:</p>
<pre><code>&lt;operation id="..." if="${variableName1} AND NOT (${variableName2} OR ${variableName3})"&gt;
  …
&lt;/operation&gt;
</code></pre>
<p>Note that XML requires certain characters like the <code>&lt;</code> and <code>&gt;</code> operators to be written as XML entities. Even if they are
used quoted in attributes. The following table shows all those characters:</p>
<pre><code class="no-highlight">&quot;  →  &amp;quot;
'  →  &amp;apos;
&lt;  →  &amp;lt;
&gt;  →  &amp;gt;
&amp;  →  &amp;amp;
</code></pre>

<p>Example:</p>
<pre><code>&lt;operation id="..." if="${yresolution} &amp;gt; 720"&gt;
  …
&lt;/operation&gt;
</code></pre>
<h2 id="test-the-workflow">Test the Workflow</h2>
<p>The easiest way to test a workflow is to just put it into the workflow folder where it will be picked up by Opencast
automatically and will be available in Opencast a few seconds later.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../external-api/" class="btn btn-neutral float-right" title="External API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../stream-security/" class="btn btn-neutral" title="Stream Security"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opencast/opencast/tree/develop/docs/guides/admin/docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../stream-security/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../external-api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
