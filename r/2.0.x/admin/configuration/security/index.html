<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Security - Opencast - Administration Guide</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Security";
    var mkdocs_page_input_path = "configuration/security.md";
    var mkdocs_page_url = "/configuration/security/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Opencast - Administration Guide</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Administration Guide</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../release.notes/">Release Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../installation/">Installation Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/multiple-servers/">Multiple Servers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/rpm-fedora/">RPM Fedora</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/rpm-rhel-sl-centos/">RPM RHEL/CentOS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/source-debian-ubuntu/">Source Debian/Ubuntu</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/source-rhel-sl-centos/">Source RHEL/CentOS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../installation/source-macosx/">Source Mac OS X</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Configuration</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../">Configuration Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../basic/">Basic</a>
                </li>
                <li class="">
                    
    <a class="" href="../database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../message-broker/">Message Broker</a>
                </li>
                <li class="">
                    
    <a class="" href="../encoding/">Encoding</a>
                </li>
                <li class="">
                    
    <a class="" href="../logging.and.privacy/">Logging and Privacy</a>
                </li>
                <li class="">
                    
    <a class="" href="../multi.tenancy/">Multi Tenancy</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Security</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#security-configuration">Security Configuration</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#introduction">Introduction</a></li>
        
            <li><a class="toctree-l4" href="#configure-access">Configure Access</a></li>
        
            <li><a class="toctree-l4" href="#authentication-provider">Authentication Provider</a></li>
        
            <li><a class="toctree-l4" href="#further-authentication-configuration">Further Authentication Configuration</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../security.cas/">Security - CAS</a>
                </li>
                <li class="">
                    
    <a class="" href="../workflow/">Workflow</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration.files.and.keys/">Configuration Files and Keys</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Modules</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../modules/">Module Configuration Home</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/atomrss/">Atom/RSS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/mediamodule.configuration/">Media Module Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.architecture/">Player - Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.configuration/">Player - Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.core.reference/">Player - Core Reference</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.events/">Player - Events</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.storage/">Player - Storage</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.plugins/">Player - Plugins</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.plugin.development/">Player - Plugin Development</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.testing/">Player - Testing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.configuration/">Player - Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/player.url.parameter/">Player - URL Parameters</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/searchindex/">Search Index</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/textextraction/">Text Extraction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/videoeditor.setup/">Video Editor - Setup</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/videoeditor.manual/">Video Editor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/videoeditor.architecture/">Video Editor - Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/videosegmentation/">Video Segmentation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../modules/youtubepublication/">YouTube publication</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Upgrade</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../upgrade/">Upgrading Home</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Workflow Operation Handlers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/">Workflow Operation Handler Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/analyzeaudio-woh/">Analyze audio WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/append-woh/">Append WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/archive-woh/">Archive WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/caption-woh/">Caption WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/compose-woh/">Compose WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/composite-woh/">Composite WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/concat-woh/">Concat WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/defaults-woh/">Defaults WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/editor-woh/">Editor WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/email-woh/">Email WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/extracttext-woh/">Extract Text WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/httpnotify-woh/">HTTP Notify WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/image-woh/">Image WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/imagetovideo-woh/">Image to Video WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/incident-woh/">Incident WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/ingestdownload-woh/">Ingest-Download WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/inspect-woh/">Inspect WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/normalizeaudio-woh/">Normalize Audio WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/postmediapackage-woh/">Post Media Package WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/prepareav-woh/">Prepare A/V WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/publishengage-woh/">Publish Engage WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/republish-woh/">Republish WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/segmentpreviews-woh/">Segment Previews WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/segmentvideo-woh/">Segment Video WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/series-woh/">Series WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/silence-woh/">Silence WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/tag-woh/">Tag WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/trim-woh/">Trim WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/waveform-woh/">Waveform WOH</a>
                </li>
                <li class="">
                    
    <a class="" href="../../workflowoperationhandlers/zip-woh/">Zip WOH</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Opencast - Administration Guide</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Configuration &raquo;</li>
        
      
    
    <li>Security</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://bitbucket.org/opencast-community/matterhorn/src/develop/docs/guides/admin/docs/src/default/docs/configuration/security.md"
          class="icon icon-bitbucket"
        > Edit on Bitbucket</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="security-configuration">Security Configuration</h1>
<p>This document will help you configure the Matterhorn security policy.</p>
<h2 id="introduction">Introduction</h2>
<p>Matterhorn service endpoints and user interfaces are secured by default using a set of servlet filters. The following
diagram illustrates the flow of an HTTP request and response through these filters.</p>
<p><img alt="Diagram" src="../security1.png" /></p>
<p>The Spring Security filters used here are very powerful, but are also somewhat complicated. Please familiarize yourself
with the basic concepts and vocabulary described in the Spring Security documentation, then edit the xml files in
<code>etc/security</code>, as described below.</p>
<h2 id="configure-access">Configure Access</h2>
<p>To configure access roles and URL patterns for a tenant, modify <code>/etc/security/{{tenant_identifier.xml}}</code>.  If you are
not hosting multiple tenants on your Matterhorn server or cluster, all configuration should be done in
<code>mh_default_org.xml</code>.</p>
<p>Some examples:</p>
<pre><code>&lt;!-- Allow anonymous access to the welcome.html URLs --&gt;
&lt;sec:intercept-url pattern='/welcome.html' access='ROLE_ANONYMOUS,ROLE_USER'/&gt;

&lt;!-- Allow anonymous GET to the search service, but not POST or PUT --&gt;
&lt;sec:intercept-url pattern='/search/**' method="GET" access='ROLE_ANONYMOUS,ROLE_USER' /&gt;

&lt;!-- Allow users with the admin role to do anything --&gt;
&lt;sec:intercept-url pattern='/**' access='ROLE_ADMIN'/&gt;
</code></pre>
<h2 id="authentication-provider">Authentication Provider</h2>
<p>Matterhorn specifies an AuthenticationProvider by default, using a UserDetailService that is obtained from the OSGI service registry.</p>
<p>You can use this simple provider as is, loading users into the mh_user and mh_role database tables, and specifying an
administrative username and password in config.properties:</p>
<pre><code>org.opencastproject.security.digest.user=matterhorn_system_account
org.opencastproject.security.digest.pass=CHANGE_ME
</code></pre>
<p>The set of user and role providers can be configured. If you do not want to keep users and passwords in Matterhorn's
database, you can replace the JpaUserAndRoleProvider with the LdapUserProvider by replacing the
matterhorn-userdirectory-jpa jar with the matterhorn-userdirectory-ldap jar.</p>
<h3 id="adding-users-to-the-matterhorn-database">Adding Users to the Matterhorn Database</h3>
<p>Additional users can be created by adding a username, organization and password hash to the mh_user table in the
Matterhorn database. The default hash method is MD5 and the password must be salted with the username in curly braces.</p>
<p><strong>At the moment, there is no graphical user interface for this task. It has to be done in the database.</strong></p>
<p>Example: Adding Garfield with the password 'monday' (in MySQL)</p>
<pre><code>INSERT INTO `matterhorn`.`mh_user` (`username`, `organization`, `password`) VALUES ('garfield', 'mh_default_org', MD5('monday{garfield}'));
</code></pre>
<p>In the next step roles for the newly created user can be added to the mh_role table. After that the created user and
role id can be added to the mh_user_role table. Here we set ROLE_USER for Garfield:</p>
<pre><code>INSERT INTO `matterhorn`.`mh_role` (`organization`, `name`, `description`) VALUES ('mh_default_org', 'ROLE_USER', 'The user role');
INSERT INTO `matterhorn`.`mh_user_role` (`user_id`, `role_id`) VALUES ('220', '221');
</code></pre>
<p><strong> Note that you must set the value of the organization field to the organization ID specified in one of the
etc/load/org.opencast.organization-<organization_name>.cfg files. In a default installation this is 'mh_default_org'.</strong></p>
<h2 id="further-authentication-configuration">Further Authentication Configuration</h2>
<p><a href="../security.cas/">Configure Central Authentication Service (CAS)</a></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../security.cas/" class="btn btn-neutral float-right" title="Security - CAS">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../multi.tenancy/" class="btn btn-neutral" title="Multi Tenancy"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://bitbucket.org/opencast-community/matterhorn/src/develop/docs/guides/admin/docs" class="icon icon-bitbucket" style="float: left; color: #fcfcfc"> BitBucket</a>
      
      
        <span><a href="../multi.tenancy/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../security.cas/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
